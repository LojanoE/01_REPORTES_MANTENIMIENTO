<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reportes de Mantenimiento</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- SheetJS (xlsx) -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <link href="styles.css" rel="stylesheet">
    <!-- Estilos personalizados -->
    <style>
        .table-container { max-height: 400px; overflow-y: auto; }
        .chart-container { height: 300px; margin-top: 20px; }
    </style>
</head>
<body>
    <div class="container mt-4">
        <div class="kpi-card">
            <div class="logo-bar">
                <img src="ECUACORRIENTE.png" alt="EcuaCorriente" class="rdv-logo">
                <h1 class="mb-4 text-center">Sistema de Reportes de Mantenimiento</h1>
                <img src="LOGO GDR.jpeg" alt="GDR" class="rdv-logo">
            </div>
        </div>

        <!-- Pestañas -->
        <ul class="nav nav-tabs" id="myTab" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="registro-tab" data-bs-toggle="tab" data-bs-target="#registro" type="button" role="tab">Registro</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="consulta-tab" data-bs-toggle="tab" data-bs-target="#consulta" type="button" role="tab">Consulta, Filtro y Gráfico</button>
            </li>
        </ul>

        <div class="tab-content mt-4" id="myTabContent">
            <!-- Pestaña 1: Registro -->
            <div class="tab-pane fade show active" id="registro" role="tabpanel">
                <form id="mantenimientoForm">
                    <div class="mb-3">
                        <label for="fechaHora" class="form-label">Fecha y Hora</label>
                        <input type="datetime-local" class="form-control" id="fechaHora" name="fechaHora" required>
                    </div>
                    <div class="mb-3">
                        <label for="responsable" class="form-label">Responsable</label>
                        <input type="text" class="form-control" id="responsable" name="responsable" required>
                    </div>
                    <div class="mb-3">
                        <label for="frente" class="form-label">Frente de Trabajo</label>
                        <input type="text" class="form-control" id="frente" name="frente" required>
                    </div>
                    <div class="mb-3">
                        <label for="tema" class="form-label">Tema / Asunto</label>
                        <input type="text" class="form-control" id="tema" name="tema" required>
                    </div>
                    <div class="mb-3">
                        <label for="actividades" class="form-label">Actividades Realizadas</label>
                        <textarea class="form-control" id="actividades" name="actividades" rows="3" required></textarea>
                    </div>
                    <div class="mb-3">
                        <label for="numeroEcsa" class="form-label">Nº Personas ECSA</label>
                        <input type="number" class="form-control" id="numeroEcsa" name="numeroEcsa" min="0" value="0" required>
                    </div>
                    <div class="mb-3">
                        <label for="numeroContratista" class="form-label">Nº Personas Contratista</label>
                        <input type="number" class="form-control" id="numeroContratista" name="numeroContratista" min="0" value="0" required>
                    </div>
                    <button type="submit" class="btn btn-primary">Registrar</button>
                </form>
                <div id="mensajeRegistro" class="mt-3"></div>
            </div>

            <!-- Pestaña 2: Consulta -->
            <div class="tab-pane fade" id="consulta" role="tabpanel">
                <div class="row mb-3">
                    <div class="col-md-6">
                        <label for="filtroResponsable" class="form-label">Responsable</label>
                        <input type="text" class="form-control" id="filtroResponsable" placeholder="Nombre...">
                    </div>
                    <div class="col-md-6">
                        <label for="filtroTema" class="form-label">Tema / Asunto</label>
                        <input type="text" class="form-control" id="filtroTema" placeholder="Tema...">
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-md-6">
                        <label for="filtroFrente" class="form-label">Frente de Trabajo</label>
                        <input type="text" class="form-control" id="filtroFrente" placeholder="Frente...">
                    </div>
                    <div class="col-md-3">
                        <label for="fechaDesde" class="form-label">Desde</label>
                        <input type="date" class="form-control" id="fechaDesde">
                    </div>
                    <div class="col-md-3">
                        <label for="fechaHasta" class="form-label">Hasta</label>
                        <input type="date" class="form-control" id="fechaHasta">
                    </div>
                </div>

                <div class="d-flex gap-2 mb-3">
                    <button id="btnCargar" class="btn btn-secondary">Cargar / Actualizar</button>
                    <button id="btnExportar" class="btn btn-success">Exportar a Excel</button>
                </div>

                <!-- Gráfico -->
                <div class="chart-container bg-white p-3">
                    <canvas id="graficoPersonas"></canvas>
                </div>

                <!-- Tabla -->
                <div class="table-container mt-3">
                    <table class="table table-striped table-hover" id="tablaRegistros">
                        <thead>
                            <tr>
                                <th>Fecha y Hora</th>
                                <th>Responsable</th>
                                <th>Tema / Asunto</th>
                                <th>Frente de Trabajo</th>
                                <th>Actividades Realizadas</th>
                                <th>Nº Personas ECSA</th>
                                <th>Nº Personas Contratista</th>
                            </tr>
                        </thead>
                        <tbody id="cuerpoTabla">
                        </tbody>
                    </table>
                </div>
                <div id="mensajeConsulta"></div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Tu script externo -->
    <script src="app.js"></script>
</body>
</html>